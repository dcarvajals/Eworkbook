/* global encodeURIComponent */

let valueLibraries, valueVariables, valueLoop, valueSetup, valueMethods;

valueLibraries = "#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n";
valueVariables = "#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n";
valueLoop = "#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n";
valueSetup = "#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n";
valueMethods = "#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n";

var jsonCodeMirror = {'Libraries': valueLibraries, 'Variables': valueVariables, 'Loop': valueLoop,
    'Setup': valueSetup, 'Methods': valueMethods};

var libraries, variables, setup, loop, methods;
loadEditCode = () => {
    libraries = CodeMirror(document.getElementById("libraries"),
            {
                lineNumbers: true,
                mode: "text/x-csrc",
                matchBrackets: true,
                value: jsonCodeMirror.Libraries,
//              readOnly: true,
                styleActiveLine: true,
                theme: 'eclipse'
            });

    variables = CodeMirror(document.getElementById("variables"),
            {
                lineNumbers: true,
                mode: "text/x-csrc",
                matchBrackets: true,
                value: jsonCodeMirror.Variables,
//              readOnly: true,
                styleActiveLine: true,
                theme: 'eclipse'
            });
    setup = CodeMirror(document.getElementById("setup"),
            {
                lineNumbers: true,
                mode: "text/x-csrc",
                matchBrackets: true,
                value: jsonCodeMirror.Setup,
//              readOnly: true,
                styleActiveLine: true,
                theme: 'eclipse'
            });
    loop = CodeMirror(document.getElementById("loop"),
            {
                lineNumbers: true,
                mode: "text/x-csrc",
                matchBrackets: true,
                value: jsonCodeMirror.Loop,
//              readOnly: true,
                styleActiveLine: true,
                theme: 'eclipse'
            });
    methods = CodeMirror(document.getElementById("methods"),
            {
                lineNumbers: true,
                mode: "text/x-csrc",
                matchBrackets: true,
                value: jsonCodeMirror.Methods,
//              readOnly: true,
                styleActiveLine: true,
                theme: 'eclipse'
            });
};

reloadCode = () => {
    libraries.setValue("#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n");
    variables.setValue("#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n");
    loop.setValue("#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n");
    setup.setValue("#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n");
    methods.setValue("#----------------------------------------------\n" +
        "#your code here -------------------------------\n" +
        "#----------------------------------------------\n" +
        "#┏━━━━┓╋┏┓╋┏┓╋╋┏┓╋┏┳━━┓╋╋┏━━━━┳┓\n" +
        "#┃┏┓┏┓┃╋┃┃╋┃┃╋╋┃┃╋┃┣┫┣┛╋╋┃┏┓┏┓┃┃\n" +
        "#┗┛┃┃┗╋━┛┣━┛┣┓┏┫┗━┛┃┃┃┏━━╋┛┃┃┗┫┗━┳━━┓\n" +
        "#╋╋┃┃╋┃┏┓┃┏┓┃┗┛┣━━┓┃┃┃┃┏┓┃╋┃┃╋┃┏┓┃━━┫\n" +
        "#╋╋┃┃╋┃┗┛┃┗┛┃┃┃┃╋╋┃┣┫┣┫┗┛┃╋┃┃╋┃┗┛┣━━┃\n" +
        "#╋╋┗┛╋┗━━┻━━┻┻┻┛╋╋┗┻━━┻━━┛╋┗┛╋┗━━┻━━┛\n");
};

b64EncodeUnicode = (str) => {
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function (match, p1) {
        return String.fromCharCode('0x' + p1);
    }));
};

function b64_to_utf8(str) {
    return decodeURIComponent(escape(window.atob(str)));
}